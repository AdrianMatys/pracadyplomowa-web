import{d as U,r as c,c as F,e as q,a as r,b as e,m as L,g,t as a,i as n,s as w,v as C,F as S,h as M,q as z,x as B,o as d,w as P,p as $,n as O}from"./vendor-lIf_UB2E.js";import{u as A,b as v,c as H}from"./main-CyjH2vMn.js";import{_ as I}from"./ConfirmationModal.vue_vue_type_script_setup_true_lang-x_qbTs3G.js";import"./axios-B9ygI19o.js";const Q={class:"space-y-6"},G={class:"flex items-center justify-between"},J={class:"text-3xl font-bold text-textWhite"},K={class:"flex gap-3"},X=["placeholder"],Y={class:"rounded-xl border border-strokePrimary/30 bg-card overflow-hidden"},Z={class:"overflow-x-auto"},ee={class:"w-full text-left border-collapse"},te={class:"bg-bgSecondary text-textSecondary uppercase text-xs"},se={class:"px-4 py-4 font-semibold hidden sm:table-cell"},oe={class:"px-4 py-4 font-semibold"},ae={class:"px-4 py-4 font-semibold hidden md:table-cell"},ne={class:"px-4 py-4 font-semibold hidden lg:table-cell"},le={class:"px-4 py-4 font-semibold text-right"},ie={class:"divide-y divide-strokePrimary/20 text-sm"},re={key:0},de={colspan:"5",class:"px-4 py-8 text-center text-textSecondary"},ce={key:1},ue={colspan:"5",class:"px-4 py-8 text-center text-textSecondary"},pe={class:"px-4 py-4 text-textSecondary font-mono hidden sm:table-cell"},me={class:"px-4 py-4 font-medium text-textWhite"},xe={class:"flex flex-col"},be={class:"text-xs text-textSecondary md:hidden mt-1"},fe={class:"text-xs text-textSecondary lg:hidden"},he={class:"px-4 py-4 hidden md:table-cell"},ye={class:"flex flex-wrap gap-1"},ge={key:0,class:"text-textSecondary text-xs"},ve={class:"px-4 py-4 text-textSecondary hidden lg:table-cell"},_e={class:"px-4 py-4 text-right"},ke={class:"hidden sm:flex items-center justify-end gap-2"},we=["onClick"],Ce={class:"sm:hidden flex items-center justify-end gap-2"},Se=["onClick"],Me={class:"bg-bgPrimary border border-strokePrimary rounded-2xl w-full max-w-md shadow-2xl overflow-hidden p-6 space-y-4"},Pe={class:"text-xl font-bold text-textWhite"},$e={class:"space-y-4"},We={class:"block text-xs font-bold text-textSecondary uppercase mb-1"},je={class:"block text-xs font-bold text-textSecondary uppercase mb-1"},De={class:"block text-xs font-bold text-textSecondary uppercase mb-1"},Le={class:"flex flex-wrap gap-2 max-h-32 overflow-y-auto p-2 bg-bgSecondary rounded-lg border border-strokePrimary/30"},Ve=["onClick"],Te={class:"flex justify-end gap-3 pt-4"},Ee=["disabled"],ze=U({__name:"AdminCoursesPage",setup(Ne){const{notify:p}=H(),{t}=A(),m=c([]),W=c([]),_=c(!0),h=c(""),j=F(()=>{if(!h.value)return m.value;const l=h.value.toLowerCase();return m.value.filter(s=>s.title.toLowerCase().includes(l))}),k=c(!1),x=c(null),b=c(!1),i=c({title:"",description:"",tags:[],image:null}),y=c(!1),V=l=>{const s=i.value.tags.indexOf(l);s===-1?i.value.tags.push(l):i.value.tags.splice(s,1)},T=l=>{const s=l.target;s.files&&s.files[0]&&(i.value.image=s.files[0])},E=async()=>{_.value=!0;try{const[l,s]=await Promise.all([v.get("/api/admin/courses"),v.get("/api/technologies")]);m.value=l.data,W.value=s.data}catch{p("error",t("admin.courses.notifications.fetchError"))}finally{_.value=!1}},D=l=>{x.value=l,k.value=!0},N=async()=>{if(x.value)try{await v.delete(`/api/admin/courses/${x.value.id}`),m.value=m.value.filter(l=>l.id!==x.value.id),p("success",t("admin.courses.notifications.deleted"))}catch{p("error",t("admin.courses.notifications.deleteError"))}},R=async()=>{if(!i.value.title){p("error",t("admin.courses.notifications.titleRequired"));return}y.value=!0;try{const l=new FormData;l.append("title",i.value.title),i.value.description&&l.append("description",i.value.description),i.value.tags.forEach(f=>l.append("tags[]",f.toString())),i.value.image&&l.append("image",i.value.image);const s=await v.post("/api/admin/courses",l,{headers:{"Content-Type":"multipart/form-data"}});m.value.unshift(s.data),p("success",t("admin.courses.notifications.created")),b.value=!1,i.value={title:"",description:"",tags:[],image:null}}catch(l){p("error",l.response?.data?.message||t("admin.courses.notifications.createError"))}finally{y.value=!1}};return q(E),(l,s)=>{const f=B("RouterLink");return d(),r("div",Q,[e("div",G,[e("h1",J,a(n(t)("admin.courses.title")),1),e("div",K,[w(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>h.value=o),type:"text",placeholder:n(t)("admin.courses.searchPlaceholder"),class:"bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-primary focus:outline-none transition-colors w-64"},null,8,X),[[C,h.value]]),e("button",{class:"px-4 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-500 transition-colors shadow-lg shadow-blue-500/20",onClick:s[1]||(s[1]=o=>b.value=!0)},"+ "+a(n(t)("admin.courses.addCourse")),1)])]),e("div",Y,[e("div",Z,[e("table",ee,[e("thead",te,[e("tr",null,[e("th",se,a(n(t)("admin.common.id")),1),e("th",oe,a(n(t)("admin.courses.table.title")),1),e("th",ae,a(n(t)("admin.courses.table.tags")),1),e("th",ne,a(n(t)("admin.courses.table.lessonsCount")),1),e("th",le,a(n(t)("admin.common.actions")),1)])]),e("tbody",ie,[_.value?(d(),r("tr",re,[e("td",de,a(n(t)("admin.common.loading")),1)])):j.value.length===0?(d(),r("tr",ce,[e("td",ue,a(n(t)("admin.courses.noCoursesFiltered")),1)])):(d(!0),r(S,{key:2},M(j.value,o=>(d(),r("tr",{key:o.id,class:"hover:bg-cardHover transition-colors"},[e("td",pe,a(o.id),1),e("td",me,[e("div",xe,[e("span",null,a(o.title),1),e("span",be,a(o.tags?.map(u=>u.name).join(", ")||"-"),1),e("span",fe,a(o.lessons_count||"0")+" "+a(n(t)("admin.courses.table.lessonsCount").toLowerCase()),1)])]),e("td",he,[e("div",ye,[(d(!0),r(S,null,M(o.tags,u=>(d(),r("span",{key:u.id,class:"px-2 py-0.5 rounded bg-blue-500/10 text-blue-400 text-[10px] font-bold uppercase"},a(u.name),1))),128)),o.tags?.length?L("",!0):(d(),r("span",ge,"-"))])]),e("td",ve,a(o.lessons_count||"0"),1),e("td",_e,[e("div",ke,[g(f,{to:`/kurs/${o.id}`,target:"_blank",class:"px-3 py-1.5 rounded bg-bgSecondary text-textWhite hover:bg-strokePrimary/50 transition-colors text-xs font-bold inline-block whitespace-nowrap"},{default:P(()=>[$(a(n(t)("admin.common.preview")),1)]),_:1},8,["to"]),g(f,{to:`/admin/courses/${o.id}`,class:"px-3 py-1.5 rounded bg-blue-500/10 text-blue-400 hover:bg-blue-500/20 transition-colors text-xs font-bold inline-block whitespace-nowrap"},{default:P(()=>[$(a(n(t)("admin.common.edit")),1)]),_:1},8,["to"]),e("button",{class:"px-3 py-1.5 rounded bg-red-500/10 text-red-500 hover:bg-red-500/20 transition-colors text-xs font-bold whitespace-nowrap",onClick:u=>D(o)},a(n(t)("admin.common.delete")),9,we)]),e("div",Ce,[g(f,{to:`/admin/courses/${o.id}`,class:"px-3 py-1.5 rounded bg-blue-500/10 text-blue-400 hover:bg-blue-500/20 transition-colors text-xs font-bold"},{default:P(()=>[$(a(n(t)("admin.common.edit")),1)]),_:1},8,["to"]),e("button",{class:"px-2 py-1.5 rounded bg-red-500/10 text-red-500 hover:bg-red-500/20 transition-colors text-xs font-bold",onClick:u=>D(o)},"âœ•",8,Se)])])]))),128))])])])]),b.value?(d(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:s[5]||(s[5]=z(o=>b.value=!1,["self"]))},[e("div",Me,[e("h3",Pe,a(n(t)("admin.courses.addModal.title")),1),e("div",$e,[e("div",null,[e("label",We,a(n(t)("admin.courses.addModal.courseTitle")),1),w(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>i.value.title=o),type:"text",class:"w-full bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-primary focus:outline-none"},null,512),[[C,i.value.title]])]),e("div",null,[e("label",je,a(n(t)("admin.courses.addModal.description")),1),w(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=o=>i.value.description=o),rows:"3",class:"w-full bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-primary focus:outline-none"},null,512),[[C,i.value.description]])]),e("div",null,[e("label",De,a(n(t)("admin.courses.table.tags")),1),e("div",Le,[(d(!0),r(S,null,M(W.value,o=>(d(),r("button",{key:o.id,class:O(["px-2 py-1 rounded-md text-xs font-bold transition-colors border",i.value.tags.includes(o.id)?"bg-primary/20 text-primary border-primary":"bg-transparent text-textSecondary border-transparent hover:bg-white/5"]),onClick:u=>V(o.id)},a(o.name),11,Ve))),128))])]),e("div",null,[s[7]||(s[7]=e("label",{class:"block text-xs font-bold text-textSecondary uppercase mb-1"},"Obrazek kursu (opcjonalnie)",-1)),e("input",{type:"file",accept:"image/*",class:"w-full text-sm text-textSecondary file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-bold file:bg-primary/20 file:text-primary hover:file:bg-primary/30 transition-colors",onChange:T},null,32)])]),e("div",Te,[e("button",{class:"px-4 py-2 rounded-lg text-textSecondary hover:text-textWhite font-semibold transition-colors",onClick:s[4]||(s[4]=o=>b.value=!1)},a(n(t)("admin.common.cancel")),1),e("button",{disabled:y.value,class:"px-4 py-2 rounded-lg bg-primary text-textWhite font-bold hover:bg-primary/90 transition-all disabled:opacity-50",onClick:R},a(y.value?n(t)("admin.courses.addModal.creating"):n(t)("admin.courses.addModal.create")),9,Ee)])])])):L("",!0),g(I,{"is-open":k.value,"onUpdate:isOpen":s[6]||(s[6]=o=>k.value=o),title:n(t)("admin.courses.deleteModal.title"),message:n(t)("admin.courses.deleteModal.message",{title:x.value?.title||""}),"confirm-text":n(t)("admin.common.delete"),"cancel-text":n(t)("admin.common.cancel"),"is-danger":"",onConfirm:N},null,8,["is-open","title","message","confirm-text","cancel-text"])])}}});export{ze as default};
