import{d as F,r as c,B as I,c as H,e as K,a as n,b as e,m,t as s,i as l,s as z,E as O,v as T,p as V,F as W,h as A,q as B,n as j,C as R,o as d}from"./vendor-lIf_UB2E.js";import{u as q,b as U,_ as J}from"./main-I4fwh5Br.js";import"./axios-B9ygI19o.js";const Q={class:"space-y-6 h-full flex flex-col relative"},G={class:"flex items-center justify-between"},X={class:"text-3xl font-bold text-textWhite"},Y={key:0,class:"text-red-500 text-sm bg-red-500/10 px-4 py-2 rounded"},Z={class:"flex gap-3 items-center"},ee={class:"flex items-center gap-2 mr-4"},te={class:"text-xs text-textSecondary uppercase font-bold"},se=["placeholder"],oe={class:"flex-1 rounded-xl border border-strokePrimary/30 bg-card overflow-hidden flex flex-col"},ae={class:"px-6 py-3 border-b border-strokePrimary/20 flex justify-between items-center bg-bgSecondary/20"},re={class:"text-xs text-textSecondary uppercase font-bold tracking-wider"},le={class:"text-textWhite"},ne={class:"text-xs text-textSecondary italic"},de={class:"overflow-auto flex-1 custom-scrollbar"},ie={class:"w-full text-left border-collapse"},ce={class:"bg-bgSecondary text-textSecondary uppercase text-xs sticky top-0 z-10"},ue={class:"px-6 py-4 font-semibold w-40"},xe={class:"px-6 py-4 font-semibold w-40"},pe={class:"px-6 py-4 font-semibold w-32"},be={class:"px-6 py-4 font-semibold"},me={class:"px-6 py-4 font-semibold w-24 text-right"},ve={class:"divide-y divide-strokePrimary/20 text-sm"},ye={key:0},ge={colspan:"5",class:"px-6 py-8 text-center text-textSecondary"},fe={key:1},he={colspan:"5",class:"px-6 py-8 text-center text-textSecondary"},_e={class:"px-6 py-3 text-textSecondary text-xs font-mono whitespace-nowrap"},ke={class:"px-6 py-3 text-textWhite font-medium text-xs"},we={class:"flex flex-col"},Se={class:"text-[10px] text-textSecondary"},Pe={class:"px-6 py-3"},Ce={class:"px-6 py-3 text-textWhite font-medium truncate max-w-xl"},ze={class:"px-6 py-3 text-right"},We=["onClick"],je={key:0,class:"p-4 border-t border-strokePrimary/30 flex justify-center items-center gap-2 bg-bgSecondary/20"},Le=["disabled"],$e=["onClick"],Me={key:1,class:"px-2 text-textSecondary font-bold"},De=["disabled"],Ne={class:"bg-bgPrimary border border-strokePrimary rounded-2xl w-full max-w-2xl flex flex-col shadow-2xl overflow-hidden"},Te={class:"p-6 border-b border-strokePrimary/30 flex justify-between items-center bg-bgSecondary/30"},Ve={class:"flex items-center gap-3"},Ae={class:"text-textSecondary text-sm font-mono"},Be={class:"p-6 space-y-4"},Ue={class:"grid grid-cols-2 gap-4"},Ee={class:"text-textWhite"},Fe={class:"text-textWhite"},Ie={key:0},He={class:"bg-[#0d1117] p-3 rounded-lg text-xs font-mono text-gray-300 whitespace-pre-wrap"},Ke={class:"p-4 border-t border-strokePrimary/30 flex justify-end bg-bgSecondary/30"},Oe={class:"bg-bgPrimary border border-red-500/30 rounded-2xl w-full max-w-md flex flex-col shadow-2xl overflow-hidden"},Re={class:"p-6 border-b border-strokePrimary/30 bg-red-500/5"},qe={class:"text-xl font-bold text-textWhite"},Je={class:"p-6 space-y-4"},Qe={class:"text-sm text-textSecondary"},Ge={class:"space-y-2"},Xe={class:"text-xs text-textSecondary uppercase font-bold block"},Ye={key:0,class:"text-xs text-red-500 bg-red-500/10 p-2 rounded"},Ze={class:"p-4 border-t border-strokePrimary/30 flex justify-end gap-3 bg-bgSecondary/30"},et=["disabled"],tt={key:0,class:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"},st=F({__name:"AdminLogsPage",setup(ot){const h=c([]),S=c(!0),i=c(null),_=c(""),u=c(1),p=c(1),k=c(50),L=c(0),P=c(null),y=c(!1),b=c(""),g=c(!1),v=c(null),{t:a}=q();let $;const f=async(r=1)=>{S.value=!0;try{const t=(await U.get("/api/admin/logs",{params:{page:r,search:_.value,per_page:k.value}})).data;h.value=t.data,u.value=t.current_page,p.value=t.last_page,L.value=t.total}catch(o){console.error("Failed to fetch logs:",o),P.value=o.message||"Unknown error",h.value=[]}finally{S.value=!1}};I([_,k],()=>{clearTimeout($),$=setTimeout(()=>{u.value=1,f(1)},300)});const M=r=>new Date(r).toLocaleString(),D=r=>r.includes("error")||r.includes("fail")?"text-red-400 bg-red-500/10":r.includes("warning")?"text-amber-400 bg-amber-500/10":r.includes("login")||r.includes("register")?"text-green-400 bg-green-500/10":r.includes("achievement")?"text-purple-400 bg-purple-500/10":"text-blue-400 bg-blue-500/10",C=r=>{r>=1&&r<=p.value&&f(r)},N=async()=>{if(!b.value){v.value="Hasło jest wymagane.";return}g.value=!0,v.value=null;try{await U.delete("/api/admin/logs/clear",{data:{password:b.value}}),y.value=!1,b.value="",f(1)}catch(r){console.error("Failed to clear logs:",r),v.value=r.response?.data?.message||"Błąd podczas czyszczenia logów."}finally{g.value=!1}},E=H(()=>{const r=[],t=u.value-2,w=u.value+2+1;for(let x=1;x<=p.value;x++)x===1||x===p.value||x>=t&&x<w?r.push(x):(x===t-1||x===w)&&r.push("...");return r});return K(()=>f()),(r,o)=>(d(),n("div",Q,[e("div",G,[e("h1",X,s(l(a)("admin.logs.title")),1),P.value?(d(),n("div",Y,"Error: "+s(P.value),1)):m("",!0),e("div",Z,[e("div",ee,[e("span",te,s(l(a)("admin.logs.perPage")||"Logów na stronę"),1),z(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>k.value=t),class:"bg-bgSecondary border border-strokePrimary/30 rounded-lg px-2 py-2 text-textWhite text-sm focus:border-primary focus:outline-none transition-colors"},[...o[12]||(o[12]=[e("option",{value:10},"10",-1),e("option",{value:20},"20",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1),e("option",{value:250},"250",-1)])],512),[[O,k.value]])]),z(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>_.value=t),type:"text",placeholder:l(a)("admin.logs.searchPlaceholder"),class:"bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-primary focus:outline-none transition-colors w-64"},null,8,se),[[T,_.value]]),e("button",{class:"px-4 py-2 bg-red-500/10 border border-red-500/30 text-red-500 rounded-lg text-sm font-semibold hover:bg-red-500/20 transition-colors",onClick:o[2]||(o[2]=t=>y.value=!0)},s(l(a)("admin.logs.clear")||"Wyczyść logi"),1),e("button",{class:"px-4 py-2 bg-bgSecondary border border-strokePrimary/30 rounded-lg text-sm font-semibold hover:bg-cardHover transition-colors",onClick:o[3]||(o[3]=t=>f(u.value))},s(l(a)("admin.logs.refresh")),1)])]),e("div",oe,[e("div",ae,[e("div",re,[V(s(l(a)("admin.logs.total")||"Razem logów")+": ",1),e("span",le,s(L.value),1)]),e("div",ne,s(l(a)("admin.logs.showingPage")||"Strona")+" "+s(u.value)+" / "+s(p.value),1)]),e("div",de,[e("table",ie,[e("thead",ce,[e("tr",null,[e("th",ue,s(l(a)("admin.common.date")),1),e("th",xe,s(l(a)("admin.logs.table.user")),1),e("th",pe,s(l(a)("admin.logs.table.action")),1),e("th",be,s(l(a)("admin.logs.table.description")),1),e("th",me,s(l(a)("admin.common.actions")),1)])]),e("tbody",ve,[S.value?(d(),n("tr",ye,[e("td",ge,s(l(a)("admin.logs.loading")),1)])):h.value.length===0?(d(),n("tr",fe,[e("td",he,s(l(a)("admin.logs.empty")),1)])):(d(!0),n(W,{key:2},A(h.value,t=>(d(),n("tr",{key:t.id,class:"hover:bg-cardHover transition-colors group"},[e("td",_e,s(M(t.created_at)),1),e("td",ke,[e("div",we,[e("span",null,s(t.user_name||"N/A"),1),e("span",Se,"ID: "+s(t.user_id),1)])]),e("td",Pe,[e("span",{class:j(["px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider",D(t.action)])},s(t.action),3)]),e("td",Ce,s(t.description),1),e("td",ze,[e("button",{class:"px-3 py-1.5 rounded bg-bgSecondary text-textSecondary hover:text-textWhite hover:bg-strokePrimary transition-colors text-xs font-bold",onClick:w=>i.value=t},s(l(a)("admin.common.details")),9,We)])]))),128))])])]),p.value>1?(d(),n("div",je,[e("button",{disabled:u.value===1,class:"h-8 w-8 flex items-center justify-center rounded bg-bgSecondary text-textSecondary hover:text-textWhite disabled:opacity-50 transition-colors",onClick:o[4]||(o[4]=t=>C(u.value-1))},"<",8,Le),(d(!0),n(W,null,A(E.value,t=>(d(),n(W,{key:t},[t!=="..."?(d(),n("button",{key:0,class:j(["h-8 w-8 flex items-center justify-center rounded text-sm font-semibold transition-all",[u.value===t?"bg-textPrimary text-bgPrimary":"bg-bgSecondary text-textSecondary hover:text-textWhite"]]),onClick:w=>C(t)},s(t),11,$e)):(d(),n("span",Me,s(t),1))],64))),128)),e("button",{disabled:u.value===p.value,class:"h-8 w-8 flex items-center justify-center rounded bg-bgSecondary text-textSecondary hover:text-textWhite disabled:opacity-50 transition-colors",onClick:o[5]||(o[5]=t=>C(u.value+1))},">",8,De)])):m("",!0)]),i.value?(d(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:o[8]||(o[8]=B(t=>i.value=null,["self"]))},[e("div",Ne,[e("div",Te,[e("div",Ve,[e("span",{class:j(["px-2 py-1 rounded text-xs font-bold uppercase",D(i.value.action)])},s(i.value.action),3),e("span",Ae,s(M(i.value.created_at)),1)]),e("button",{class:"text-textSecondary hover:text-textWhite transition-colors p-2",onClick:o[6]||(o[6]=t=>i.value=null)},"✕")]),e("div",Be,[e("div",Ue,[e("div",null,[o[13]||(o[13]=e("label",{class:"text-xs text-textSecondary uppercase font-bold block mb-1"},"User",-1)),e("div",Ee,s(i.value.user_name||"N/A")+" (ID: "+s(i.value.user_id)+")",1)])]),e("div",null,[o[14]||(o[14]=e("label",{class:"text-xs text-textSecondary uppercase font-bold block mb-1"},"Description",-1)),e("div",Fe,s(i.value.description),1)]),i.value.metadata?(d(),n("div",Ie,[o[15]||(o[15]=e("label",{class:"text-xs text-textSecondary uppercase font-bold block mb-1"},"Metadata",-1)),e("pre",He,s(JSON.stringify(i.value.metadata,null,2)),1)])):m("",!0)]),e("div",Ke,[e("button",{class:"px-6 py-2 bg-textPrimary text-bgPrimary font-bold rounded-lg hover:opacity-90 transition-opacity",onClick:o[7]||(o[7]=t=>i.value=null)},s(l(a)("admin.common.close")),1)])])])):m("",!0),y.value?(d(),n("div",{key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:o[11]||(o[11]=B(t=>y.value=!1,["self"]))},[e("div",Oe,[e("div",Re,[e("h3",qe,s(l(a)("admin.logs.clearModal.title")||"Wyczyścić logi?"),1)]),e("div",Je,[e("p",Qe,s(l(a)("admin.logs.clearModal.description")||"Tej operacji nie można cofnąć. Wszystkie dotychczasowe logi zostaną usunięte z bazy danych. W celu potwierdzenia wpisz hasło do swojego konta administratora."),1),e("div",Ge,[e("label",Xe,s(l(a)("login.passwordLabel")),1),z(e("input",{"onUpdate:modelValue":o[9]||(o[9]=t=>b.value=t),type:"password",placeholder:"••••••••",class:"w-full bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-red-500 focus:outline-none transition-colors",onKeyup:R(N,["enter"])},null,544),[[T,b.value]])]),v.value?(d(),n("div",Ye,s(v.value),1)):m("",!0)]),e("div",Ze,[e("button",{class:"px-4 py-2 rounded-lg text-sm font-semibold text-textSecondary hover:text-textWhite transition-colors",onClick:o[10]||(o[10]=t=>{y.value=!1,b.value="",v.value=null})},s(l(a)("common.cancel")),1),e("button",{class:"px-6 py-2 bg-red-500 text-white font-bold rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 flex items-center gap-2",disabled:g.value||!b.value,onClick:N},[g.value?(d(),n("span",tt)):m("",!0),V(" "+s(g.value?l(a)("common.loading"):l(a)("admin.logs.clearConfirm")||"Potwierdzam i czyszczę"),1)],8,et)])])])):m("",!0)]))}}),nt=J(st,[["__scopeId","data-v-5184dc2d"]]);export{nt as default};
