import{d as q,r as c,c as E,e as I,a as r,b as e,m as D,g as k,t as n,i as o,s as _,v as g,F as C,h as S,q as O,w as L,p as N,x as z,n as M,f as T,o as i}from"./vendor-lIf_UB2E.js";import{u as F,b as h,c as H}from"./main-AnIw5FzX.js";import{_ as Q}from"./ConfirmationModal.vue_vue_type_script_setup_true_lang-x_qbTs3G.js";import{I as G,a as J}from"./IconEyeOff-G91UlkKc.js";import"./axios-B9ygI19o.js";const K={class:"space-y-6"},X={class:"flex items-center justify-between"},Y={class:"text-3xl font-bold text-textWhite"},Z={class:"flex gap-3"},ee=["placeholder"],te={class:"rounded-xl border border-strokePrimary/30 bg-card"},se={class:"overflow-x-auto"},oe={class:"w-full text-left border-collapse"},ne={class:"bg-bgSecondary text-textSecondary uppercase text-xs"},ae={class:"px-4 py-4 font-semibold hidden sm:table-cell"},le={class:"px-4 py-4 font-semibold"},de={class:"px-4 py-4 font-semibold hidden md:table-cell"},ie={class:"px-4 py-4 font-semibold hidden lg:table-cell"},re={class:"px-4 py-4 font-semibold hidden xl:table-cell"},ce={class:"px-4 py-4 font-semibold text-right"},ue={class:"divide-y divide-strokePrimary/20 text-sm"},me={key:0},pe={colspan:"6",class:"px-4 py-8 text-center text-textSecondary"},xe={key:1},be={colspan:"6",class:"px-4 py-8 text-center text-textSecondary"},he={class:"px-4 py-4 text-textSecondary font-mono hidden sm:table-cell"},ye={class:"px-4 py-4 font-medium text-textWhite"},fe={class:"flex flex-col"},_e={class:"text-xs text-textSecondary lg:hidden"},ge={class:"px-4 py-4 hidden md:table-cell"},ve={class:"flex flex-wrap gap-1"},we={key:0,class:"text-textSecondary text-xs"},ke={class:"px-4 py-4 text-textSecondary hidden lg:table-cell"},Ce={class:"px-4 py-4 text-textSecondary hidden xl:table-cell whitespace-nowrap"},Se={class:"px-4 py-4 text-right"},Me={class:"hidden md:flex items-center justify-end gap-2"},Pe=["href"],$e=["onClick"],We=["onClick"],Ae={class:"md:hidden flex items-center justify-end gap-2"},Ve=["onClick"],De=["onClick"],Le={class:"bg-bgPrimary border border-strokePrimary rounded-2xl w-full max-w-md shadow-2xl overflow-hidden p-6 space-y-4"},Ne={class:"text-xl font-bold text-textWhite"},Te={class:"space-y-4"},je={class:"block text-xs font-bold text-textSecondary uppercase mb-1"},Re={class:"block text-xs font-bold text-textSecondary uppercase mb-1"},Ue={class:"flex flex-wrap gap-2 max-h-32 overflow-y-auto p-2 bg-bgSecondary rounded-lg border border-strokePrimary/30"},Be=["onClick"],qe={class:"block text-xs font-bold text-textSecondary uppercase mb-1"},Ee=["placeholder"],Ie={class:"block text-xs font-bold text-textSecondary uppercase mb-1"},Oe={class:"flex justify-end gap-3 pt-4"},ze=["disabled"],Xe=q({__name:"AdminNewsPage",setup(Fe){const{notify:u}=H(),{t}=F(),p=c([]),P=c([]),v=c(!0),y=c(""),$=E(()=>{if(!y.value)return p.value;const l=y.value.toLowerCase();return p.value.filter(a=>a.title.toLowerCase().includes(l))}),w=c(!1),x=c(null),b=c(!1),d=c({title:"",content:"",type:"news",tags:[],estimated_time:null}),f=c(!1),j=l=>{const a=d.value.tags.indexOf(l);a===-1?d.value.tags.push(l):d.value.tags.splice(a,1)},R=async()=>{v.value=!0;try{const[l,a]=await Promise.all([h.get("/api/admin/news"),h.get("/api/technologies")]);p.value=l.data.data,P.value=a.data}catch{u("error",t("admin.common.error"))}finally{v.value=!1}},W=l=>{x.value=l,w.value=!0},U=async()=>{if(x.value)try{await h.delete(`/api/admin/news/${x.value.id}`),p.value=p.value.filter(l=>l.id!==x.value.id),u("success",t("admin.common.notifications.success"))}catch{u("error",t("admin.common.error"))}},A=async l=>{try{const a=await h.patch(`/api/admin/news/${l.id}/toggle-publish`);l.is_published=a.data.is_published,u("success",l.is_published?t("admin.news.published"):t("admin.news.hidden"))}catch{u("error",t("admin.common.error"))}},B=async()=>{if(!d.value.title){u("error",t("admin.news.titleRequired"));return}f.value=!0;try{const l=await h.post("/api/admin/news",d.value);p.value.unshift(l.data),u("success",t("admin.common.notifications.success")),b.value=!1,d.value={title:"",content:"",type:"news",tags:[],estimated_time:null}}catch(l){u("error",l.response?.data?.message||t("admin.common.error"))}finally{f.value=!1}};return I(R),(l,a)=>{const V=z("RouterLink");return i(),r("div",K,[e("div",X,[e("h1",Y,n(o(t)("admin.news.title")),1),e("div",Z,[_(e("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>y.value=s),type:"text",placeholder:o(t)("admin.common.search"),class:"bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-primary focus:outline-none transition-colors w-64"},null,8,ee),[[g,y.value]]),e("button",{class:"px-4 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-500 transition-colors shadow-lg shadow-blue-500/20",onClick:a[1]||(a[1]=s=>b.value=!0)},"+ "+n(o(t)("admin.news.addArticle")),1)])]),e("div",te,[e("div",se,[e("table",oe,[e("thead",ne,[e("tr",null,[e("th",ae,n(o(t)("admin.common.id")),1),e("th",le,n(o(t)("admin.news.table.title")),1),e("th",de,n(o(t)("admin.news.table.tags")),1),e("th",ie,n(o(t)("admin.news.table.author")),1),e("th",re,n(o(t)("admin.news.table.date")),1),e("th",ce,n(o(t)("admin.common.actions")),1)])]),e("tbody",ue,[v.value?(i(),r("tr",me,[e("td",pe,n(o(t)("admin.common.loading")),1)])):$.value.length===0?(i(),r("tr",xe,[e("td",be,n(o(t)("admin.news.noNews")),1)])):(i(!0),r(C,{key:2},S($.value,s=>(i(),r("tr",{key:s.id,class:"hover:bg-cardHover transition-colors"},[e("td",he,n(s.id),1),e("td",ye,[e("div",fe,[e("span",null,n(s.title),1),e("span",_e,n(s.user.profile?.nickname||s.user.email),1)])]),e("td",ge,[e("div",ve,[(i(!0),r(C,null,S(s.tags,m=>(i(),r("span",{key:m.id,class:"px-2 py-0.5 rounded bg-gray-500/10 text-gray-400 text-[10px] font-bold uppercase"},n(m.name),1))),128)),s.tags?.length?D("",!0):(i(),r("span",we,"-"))])]),e("td",ke,n(s.user.profile?.nickname||s.user.email),1),e("td",Ce,n(new Date(s.created_at).toLocaleDateString()),1),e("td",Se,[e("div",Me,[e("a",{href:`/artykul/${s.id}`,target:"_blank",class:"px-3 py-1.5 rounded bg-bgSecondary text-textWhite hover:bg-strokePrimary/50 transition-colors text-xs font-bold whitespace-nowrap"},n(o(t)("admin.common.preview")),9,Pe),k(V,{to:`/admin/news/${s.id}`,class:"px-3 py-1.5 rounded bg-blue-500/10 text-blue-400 hover:bg-blue-500/20 transition-colors text-xs font-bold whitespace-nowrap"},{default:L(()=>[N(n(o(t)("admin.common.edit")),1)]),_:1},8,["to"]),e("button",{class:M(["px-3 py-1.5 rounded text-xs font-bold transition-colors whitespace-nowrap",s.is_published?"bg-yellow-500/10 text-yellow-400 hover:bg-yellow-500/20":"bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20"]),onClick:m=>A(s)},n(s.is_published?o(t)("admin.news.hide"):o(t)("admin.news.publish")),11,$e),e("button",{class:"px-3 py-1.5 rounded bg-red-500/10 text-red-500 hover:bg-red-500/20 transition-colors text-xs font-bold whitespace-nowrap",onClick:m=>W(s)},n(o(t)("admin.common.delete")),9,We)]),e("div",Ae,[k(V,{to:`/admin/news/${s.id}`,class:"px-3 py-1.5 rounded bg-blue-500/10 text-blue-400 hover:bg-blue-500/20 transition-colors text-xs font-bold"},{default:L(()=>[N(n(o(t)("admin.common.edit")),1)]),_:1},8,["to"]),e("button",{class:M(["px-2 py-1.5 rounded text-xs font-bold transition-colors flex items-center justify-center",s.is_published?"bg-yellow-500/10 text-yellow-400":"bg-emerald-500/10 text-emerald-400"]),onClick:m=>A(s)},[s.is_published?(i(),T(G,{key:0,class:"h-4 w-4"})):(i(),T(J,{key:1,class:"h-4 w-4"}))],10,Ve),e("button",{class:"px-2 py-1.5 rounded bg-red-500/10 text-red-500 transition-colors text-xs font-bold",onClick:m=>W(s)},"âœ•",8,De)])])]))),128))])])])]),b.value?(i(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:a[6]||(a[6]=O(s=>b.value=!1,["self"]))},[e("div",Le,[e("h3",Ne,n(o(t)("admin.news.addModal.title")),1),e("div",Te,[e("div",null,[e("label",je,n(o(t)("admin.news.addModal.articleTitle")),1),_(e("input",{"onUpdate:modelValue":a[2]||(a[2]=s=>d.value.title=s),type:"text",class:"w-full bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-primary focus:outline-none"},null,512),[[g,d.value.title]])]),e("div",null,[e("label",Re,n(o(t)("admin.news.addModal.tags")),1),e("div",Ue,[(i(!0),r(C,null,S(P.value,s=>(i(),r("button",{key:s.id,class:M(["px-2 py-1 rounded-md text-xs font-bold transition-colors border",d.value.tags.includes(s.id)?"bg-primary/20 text-primary border-primary":"bg-transparent text-textSecondary border-transparent hover:bg-white/5"]),onClick:m=>j(s.id)},n(s.name),11,Be))),128))])]),e("div",null,[e("label",qe,n(o(t)("admin.news.addModal.readingTime")),1),_(e("input",{"onUpdate:modelValue":a[3]||(a[3]=s=>d.value.estimated_time=s),type:"number",min:"1",placeholder:o(t)("admin.news.addModal.readingTimePlaceholder"),class:"w-full bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-primary focus:outline-none"},null,8,Ee),[[g,d.value.estimated_time,void 0,{number:!0}]])]),e("div",null,[e("label",Ie,n(o(t)("admin.news.addModal.content")),1),_(e("textarea",{"onUpdate:modelValue":a[4]||(a[4]=s=>d.value.content=s),rows:"5",class:"w-full bg-bgSecondary border border-strokePrimary/30 rounded-lg px-4 py-2 text-textWhite text-sm focus:border-primary focus:outline-none"},null,512),[[g,d.value.content]])])]),e("div",Oe,[e("button",{class:"px-4 py-2 rounded-lg text-textSecondary hover:text-textWhite font-semibold transition-colors",onClick:a[5]||(a[5]=s=>b.value=!1)},n(o(t)("admin.common.cancel")),1),e("button",{disabled:f.value,class:"px-4 py-2 rounded-lg bg-primary text-textWhite font-bold hover:bg-primary/90 transition-all disabled:opacity-50",onClick:B},n(f.value?o(t)("admin.news.addModal.creating"):o(t)("admin.news.addModal.create")),9,ze)])])])):D("",!0),k(Q,{"is-open":w.value,"onUpdate:isOpen":a[7]||(a[7]=s=>w.value=s),title:o(t)("admin.news.deleteModal.title"),message:o(t)("admin.news.deleteModal.message",{title:x.value?.title||""}),"confirm-text":o(t)("admin.common.delete"),"cancel-text":o(t)("admin.common.cancel"),"is-danger":"",onConfirm:U},null,8,["is-open","title","message","confirm-text","cancel-text"])])}}});export{Xe as default};
